{% extends 'dm/base_ws.html' %}

{% block head %}
    <title>oTree Manager Home</title>
{% endblock %}

{% block menu %}

    <div class="ui dropdown icon item">
        <i class="red wrench icon"></i>
        <div class="menu">
            {% if perms.can_add_instance %}
            <a class="item" href="/new_app">
                <i class="hdd icon"></i>
                New oTree Server
            </a>
            {% endif %}
            <div class="divider"></div>
            {% if perms.can_add_user %}
            <a class="item" href="/new_user">
                <i class="user plus icon"></i>
                New Experimenter
            </a>
            {% endif %}
        </div>
    </div>
{% endblock %}

{% block content %}
    <h1>oTree Manager</h1>
    <div class="ui divider"></div>
    <h2>Active oTree instances</h2>
    <div class="ui relaxed divided list">
        {% for instance in instances %}
            <div class="item">
                <i class="large middle aligned server icon"></i>
                <div class="content">
                    <a class="header" href="detail/{{ instance.id }}">{{ instance.name }} <div class="ui inline mini loader"></div></a>
                    <p class="description">assigned to {{ instance.owned_by.first_name }} {{ instance.owned_by.last_name }}</p>
                </div>
            </div>
        {% endfor %}
    </div>
{% endblock %}

{% block scripts %}
    <script type="text/javascript">
        $(".close.icon").click(function(){
            $(this).parent().hide();
        });

        $('#long_task').click(function() {
            wsBridge.send({'action':'run', 'message':'long_task'});
            console.log('action: run, message: long_task');
        });
    </script>
{% endblock %}