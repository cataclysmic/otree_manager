{% extends 'dm/base.html' %}
{% block head %}
	<title>App Creation</title>
	<style type="text/css">
		#app_name {
			width: 150px; 
		}
	</style>
{% endblock %}

{% block content %}
	<div class="ui breadcrumb">
		<i class="right angle icon divider"></i>
		<a class="section" href="/">Home</a>
		<i class="right angle icon divider"></i>
		<div class="section active">New</div>
	</div>
	<h1>New Instance</h1>
	<div class="ui divider"></div>
	<form method="POST" action="/new_app/">
		{% csrf_token %}
		<div class="ui error form">
			{% if form.non_field_errors %}
				<div class="ui error message">
					{{ form.non_field_errors }}
				</div>
			{% endif %}
			<div class="field">
				{{ form.name.label_tag }}
				<div class="ui input">
					{{ form.name }}
				</div>
				<p><em>Must only contain [a-Z, 0-9].</em></p>
				{% if form.name.errors %}
				<div class="ui error message">
					{{ form.name.errors }}
				</div>
				{% endif %}
				
			</div>
			<div class="field">
				{{ form.owned_by.label_tag }}
				<div class="ui fluid search selection dropdown">
					<input type="hidden" name="{{ form.owned_by.html_name }}">
					<i class="dropdown icon"></i>
					<div class="default text">Experimenters</div>
					<div class="menu">
						{% for choice, label in form.fields.owned_by.choices %}
							{% if choice %}
								<div class="item" data-value="{{choice}}">{{ label }}</div>
							{% endif %}
						{% endfor %}
					</div>
				</div>
				{% if form.owned_by.errors %}
				<div class="ui error message">
					{{ form.owned_by.errors }}
				</div>
				{% endif %}
			</div>
			<div class="grouped fields">
				<label>Plugins</label>
				<p><em>Both plugins are required for oTree production instances!</em></p>
				{% for plugin in form.enabled_plugins %}
					<div class="field">
						<div class="ui toggle checkbox">
						 	{{ plugin.tag }}
							<label>{{ plugin.choice_label }}</label>
						</div>
					</div>
				{% endfor %}
			</div>
			<button class="ui primary button">
			    Create
			</button>
		</div>
		
	</form>
{% endblock %}

{% block scripts %}
	<script type="text/javascript">
		$(".ui.button").on("click", function () {
			$(this).addClass('loading');
		});
		$('.ui.dropdown').dropdown({ 'fullTextSearch': 'exact'});
	</script>
{% endblock %}