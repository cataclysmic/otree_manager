{% extends 'dm/base.html' %}
{% block head %}
	<title>Detail view</title>
{% endblock%}
{% block content %}
	<div class="ui breadcrumb">
		<i class="right angle icon divider"></i>
		<a class="section" href="/">Home</a>
		<i class="right angle icon divider"></i>
		<a class="active">Details</a>
		<i class="right angle icon divider"></i>
		<div class="section active">{{ instance.name }}</div>
	</div>
	<h1>{{ instance.name }}</h1>
	<div class="ui divider"></div>
	<p><b>Status Report</b></p>
	<table class="ui very basic compact table">
		<tbody>
			<tr>
				<td>Experimenter</td>
				<td>{{ instance.owned_by.first_name }} {{ instance.owned_by.last_name }}</td>
			</tr>
			<tr>
				<td>Git Repository URL</td>
				<td>{{ instance.git_url }} </td>
			</tr>
			<tr>
				<td>Deployed</td>
				<td>{{ instance.deployed }}</td>
			</tr>
			<tr>
				<td>URL</td>
				<td><a href="{{ instance.url }}" target="_blank">{{ instance.url }}</td>
			</tr>
		<tr>
			<td>Plugins</td>
			<td>
				<div class="ui list">
					{% for plugin in instance.enabled_plugins.all %}
						<div class="item">
							{{ plugin.verbose_name }}
						</div>
					{% endfor %}
				</div>
			</td>

		</tbody>
	</table>
	
	<div class="ui divider"></div>
		{% if permissions.can_restart %}
		<a id="restart_button" class="ui basic button">Restart this instance</a> 
		{% endif %}
		{% if permissions.can_delete %}
		<a id="delete_button" class="ui button negative">Delete this instance</a><br>
		{% endif %}
	</div>

	<div class="ui basic modal">
		<div class="ui icon header">
			<i class="trash icon"></i>
			Delete oTree Instance
		</div>
		<div class="content">
			<p style="text-align: center;">Are you sure you want to delete this instance?</p>
		</div>
		<div class="actions">
			<div class="ui red inverted deny button">
				<i class="remove icon"></i>
				No
			</div>
			<div class="ui inverted basic approve button">
				<i class="checkmark icon"></i>
				Yes
			</div>
		</div>
	</div>
{% endblock %}
{%block scripts %}
	<script type="text/javascript">
		$(".ui.button.progress").on("click", function () {
			$(this).addClass('loading');
		});
		$("#delete_button").click(function () {
			$(".ui.modal").modal('setting', {
				onApprove: function () {
					$(".ui.approve.button").addClass('loading');
					$(".ui.deny.button").addClass("disabled");
					window.location.href = "/delete/{{ instance.id }}";
					return false;
				},
				closable: false,
			}).modal('show');
		});
	</script>
{% endblock %}